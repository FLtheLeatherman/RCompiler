# 测试运行器使用说明

## 概述

`run_test` 是一个用于运行特定测试点的 C++ 程序。它可以对指定的测试点进行完整的编译器前端分析，包括词法分析、语法分析、符号收集、常量求值、结构体检查和类型检查。

## 使用方法

```bash
cd build
./run_test <test_name>
```

## 参数说明

- `<test_name>`: 测试点名称，程序会在 `../.RCompiler-Testcases/semantic-1/src/<test_name>/<test_name>.rx` 路径查找测试文件。

## 示例

```bash
# 运行名为 "basic1" 的测试点
./run_test basic1

# 运行名为 "array1" 的测试点  
./run_test array1
```

## 功能特性

测试运行器会执行以下步骤：

1. **文件检查**: 验证测试文件是否存在
2. **词法分析**: 将源代码转换为 token 序列
3. **语法分析**: 构建 AST（抽象语法树）
4. **AST 打印**: 输出完整的 AST 结构
5. **符号收集**: 收集所有符号信息并构建作用域
6. **内建函数添加**: 添加所有预定义的内建函数和方法
7. **常量求值**: 计算编译时常量
8. **结构体检查**: 验证结构体定义和使用
9. **类型检查**: 执行完整的类型分析和推断
10. **作用域打印**: 显示最终的作用域和符号信息

## 内建函数支持

测试运行器包含以下内建函数：

### 全局函数
- `getString() -> String`
- `getInt() -> i32`
- `exit(code: i32) -> ()`
- `print(s: &str) -> ()`
- `println(s: &str) -> ()`
- `printInt(n: i32) -> ()`
- `printlnInt(n: i32) -> ()`

### 方法
- `u32.to_string(&self) -> String`
- `usize.to_string(&self) -> String`
- `String.as_str(&self) -> &str`
- `String.len(&self) -> u32`
- `str.len(&self) -> u32`

## 输出格式

程序会输出详细的处理过程，包括：
- Token 数量和类型
- 完整的 AST 结构
- 各个阶段的符号表信息
- 类型检查的调试信息（如果启用）
- 最终的作用域内容

## 错误处理

如果测试过程中出现错误，程序会：
1. 显示详细的错误信息
2. 返回非零退出码
3. 在可能的情况下继续执行后续步骤

## 注意事项

- 确保测试文件路径正确
- 测试文件必须是有效的 Rust 子集代码
- 程序会输出大量调试信息，适合开发和分析使用